<html lang="en"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6ImVkMTFlZDM5MmY5YzMwZjkyMGE1OGIzYmQ1NGUyZTI3MjIxZTkwMjQiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIxNjY2NjI1NjQ0MDY1MDc2OTYyNyIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzdiNTA2ZmFmNDdhNzMxYWFfaW5kZXguaHRtbC03ODkifSwiZXhwIjoxNzY3ODkyNjQyLCJpYXQiOjE3Njc4ODkwNDIsImFsZyI6IlJTMjU2In0.rTv2CgNmlyr4uuhoH-gSCXK06_Zczt3db7Zss3HgksEPNDOR-CSbRQxOqsRGYZYnzYteLKm5td9hIjZxBtBblyHlepBg2p6p94RH8nEO86i1WtXvnnnhTTA3pgjzavjY1BCmsf1ZFbftPam0SHdiTUKUq0o7qe0iNvRSLo2xDpWyXwfrnqPTQ1x_m6tkR4cWGVnL6FP2-4EUxLZ3nuNRyBQUCzar4oatn7h_zUwQco23zzDqMgnMTj-6n9jkIChbP54AXcq3h4tG-4c5193LYZK2zSfZybjA2bzI084FrbX8kqdEBPS9ct0S2ppVCyIWNp_dxLrCBxhVQ-glTp3KPA","c_7b506faf47a731aa_index.html-789")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbit Code Runner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest" crossorigin="anonymous"></script>
    <!-- Add JSZip for handling zip files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" crossorigin="anonymous"></script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #1e1e1e; }
        ::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280; }

        /* Editor specific styles */
        .editor-textarea {
            tab-size: 2;
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            line-height: 1.5;
            resize: none;
            outline: none;
        }

        .gutter { user-select: none; }

        /* Console log styles */
        .log-entry {
            border-bottom: 1px solid #374151;
            padding: 4px 8px;
            font-family: monospace;
            font-size: 0.85rem;
        }
        .log-error { color: #f87171; background: rgba(127, 29, 29, 0.2); }
        .log-warn { color: #fbbf24; background: rgba(120, 53, 15, 0.2); }
        .log-info { color: #e5e7eb; }

        /* File Explorer Item */
        .file-item {
            cursor: pointer;
            padding: 4px 8px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 6px;
            color: #9ca3af;
        }
        .file-item:hover { background: #374151; color: white; }
        .file-item.active { background: #2563eb; color: white; }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.relative{position:relative}.inset-0{inset:0px}.z-50{z-index:50}.mx-4{margin-left:1rem;margin-right:1rem}.mr-2{margin-right:0.5rem}.mb-2{margin-bottom:0.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.ml-auto{margin-left:auto}.inline{display:inline}.flex{display:flex}.hidden{display:none}.h-screen{height:100vh}.h-14{height:3.5rem}.h-3\.5{height:0.875rem}.h-4{height:1rem}.h-full{height:100%}.h-3{height:0.75rem}.h-48{height:12rem}.h-6{height:1.5rem}.w-12{width:3rem}.w-3\.5{width:0.875rem}.w-4{width:1rem}.w-48{width:12rem}.w-full{width:100%}.w-3{width:0.75rem}.w-6{width:1.5rem}.min-w-0{min-width:0px}.max-w-md{max-width:28rem}.max-w-sm{max-width:24rem}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-pre-line{white-space:pre-line}.rounded{border-radius:0.25rem}.rounded-md{border-radius:0.375rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-none{border-style:none}.border-\[\#333\]{--tw-border-opacity:1;border-color:rgb(51 51 51 / var(--tw-border-opacity, 1))}.border-blue-900\/50{border-color:rgb(30 58 138 / 0.5)}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-700{--tw-border-opacity:1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1))}.border-gray-800{--tw-border-opacity:1;border-color:rgb(31 41 55 / var(--tw-border-opacity, 1))}.border-purple-900\/50{border-color:rgb(88 28 135 / 0.5)}.bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.bg-\[\#18181b\]{--tw-bg-opacity:1;background-color:rgb(24 24 27 / var(--tw-bg-opacity, 1))}.bg-\[\#1e1e1e\]{--tw-bg-opacity:1;background-color:rgb(30 30 30 / var(--tw-bg-opacity, 1))}.bg-\[\#252526\]{--tw-bg-opacity:1;background-color:rgb(37 37 38 / var(--tw-bg-opacity, 1))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-600{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-yellow-600{--tw-bg-opacity:1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1))}.bg-\[\#0d0d0d\]{--tw-bg-opacity:1;background-color:rgb(13 13 13 / var(--tw-bg-opacity, 1))}.bg-\[\#1a1a1a\]{--tw-bg-opacity:1;background-color:rgb(26 26 26 / var(--tw-bg-opacity, 1))}.bg-black\/50{background-color:rgb(0 0 0 / 0.5)}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-blue-900\/50{background-color:rgb(30 58 138 / 0.5)}.bg-red-600{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.fill-current{fill:currentColor}.p-1{padding:0.25rem}.p-2{padding:0.5rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-1\.5{padding-top:0.375rem;padding-bottom:0.375rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.pr-3{padding-right:0.75rem}.pt-4{padding-top:1rem}.text-right{text-align:right}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-\[10px\]{font-size:10px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-6{line-height:1.5rem}.tracking-wide{letter-spacing:0.025em}.tracking-wider{letter-spacing:0.05em}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-blue-300{--tw-text-opacity:1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.text-blue-400{--tw-text-opacity:1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-purple-300{--tw-text-opacity:1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.text-blue-200{--tw-text-opacity:1;color:rgb(191 219 254 / var(--tw-text-opacity, 1))}.opacity-50{opacity:0.5}.opacity-0{opacity:0}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-green-900\/50{--tw-shadow-color:rgb(20 83 45 / 0.5);--tw-shadow:var(--tw-shadow-colored)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-300{transition-duration:300ms}.hover\:bg-blue-900\/30:hover{background-color:rgb(30 58 138 / 0.3)}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-700:hover{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-700\/50:hover{background-color:rgb(55 65 81 / 0.5)}.hover\:bg-green-500:hover{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-900\/30:hover{background-color:rgb(88 28 135 / 0.3)}.hover\:bg-yellow-500:hover{--tw-bg-opacity:1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-500:hover{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500:hover{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.hover\:text-blue-100:hover{--tw-text-opacity:1;color:rgb(219 234 254 / var(--tw-text-opacity, 1))}.hover\:text-gray-100:hover{--tw-text-opacity:1;color:rgb(243 244 246 / var(--tw-text-opacity, 1))}.hover\:text-purple-100:hover{--tw-text-opacity:1;color:rgb(243 232 255 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.hover\:text-red-400:hover{--tw-text-opacity:1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.active\:scale-95:active{--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:opacity-100{opacity:1}@media (min-width: 640px){.sm\:block{display:block}.sm\:inline{display:inline}.sm\:flex{display:flex}.sm\:hidden{display:none}}@media (min-width: 768px){.md\:flex{display:flex}.md\:hidden{display:none}.md\:w-1\/2{width:50%}.md\:flex-row{flex-direction:row}}@media (min-width: 1024px){.lg\:inline{display:inline}}</style><script>
                window.__PRELOADED_FILES__ = {"index.html":{"content":"<!DOCTYPE html>\n<html>\n<head>\n    <link rel=\"stylesheet\" href=\"style.css\">\n</head>\n<body>\n    <div class=\"container\">\n        <h1>Orbit Code Runner</h1>\n        <p>This is a starter template.</p>\n        <button onclick=\"showAlert()\">Click Me</button>\n    </div>\n    <script src=\"script.js\"><\/script>\n</body>\n</html>","type":"text/html"},"style.css":{"content":"body {\n    font-family: sans-serif;\n    background: #1e1e1e;\n    color: white;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: 100vh;\n    margin: 0;\n}\n.container {\n    text-align: center;\n    background: #2d2d2d;\n    padding: 2rem;\n    border-radius: 8px;\n    border: 1px solid #3d3d3d;\n}\nbutton {\n    margin-top: 1rem;\n    padding: 0.5rem 1rem;\n    background: #3b82f6;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n}\nbutton:hover { background: #2563eb; }","type":"text/css"},"script.js":{"content":"function showAlert() {\n    console.log(\"Hello from Orbit!\");\n    alert(\"System operational!\");\n}","type":"text/javascript"}};
                window.__PRELOADED_ACTIVE__ = "index.html";
            </script><style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.relative{position:relative}.inset-0{inset:0px}.z-50{z-index:50}.mx-4{margin-left:1rem;margin-right:1rem}.ml-auto{margin-left:auto}.mr-2{margin-right:0.5rem}.mb-2{margin-bottom:0.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.inline{display:inline}.flex{display:flex}.hidden{display:none}.h-screen{height:100vh}.h-14{height:3.5rem}.h-3{height:0.75rem}.h-3\.5{height:0.875rem}.h-4{height:1rem}.h-full{height:100%}.h-48{height:12rem}.h-6{height:1.5rem}.w-12{width:3rem}.w-3{width:0.75rem}.w-3\.5{width:0.875rem}.w-4{width:1rem}.w-48{width:12rem}.w-full{width:100%}.w-6{width:1.5rem}.min-w-0{min-width:0px}.max-w-md{max-width:28rem}.max-w-sm{max-width:24rem}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-pre-line{white-space:pre-line}.rounded{border-radius:0.25rem}.rounded-md{border-radius:0.375rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-none{border-style:none}.border-\[\#333\]{--tw-border-opacity:1;border-color:rgb(51 51 51 / var(--tw-border-opacity, 1))}.border-blue-900\/50{border-color:rgb(30 58 138 / 0.5)}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-700{--tw-border-opacity:1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1))}.border-gray-800{--tw-border-opacity:1;border-color:rgb(31 41 55 / var(--tw-border-opacity, 1))}.border-purple-900\/50{border-color:rgb(88 28 135 / 0.5)}.bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.bg-\[\#18181b\]{--tw-bg-opacity:1;background-color:rgb(24 24 27 / var(--tw-bg-opacity, 1))}.bg-\[\#1e1e1e\]{--tw-bg-opacity:1;background-color:rgb(30 30 30 / var(--tw-bg-opacity, 1))}.bg-\[\#252526\]{--tw-bg-opacity:1;background-color:rgb(37 37 38 / var(--tw-bg-opacity, 1))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-600{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-yellow-600{--tw-bg-opacity:1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1))}.bg-\[\#0d0d0d\]{--tw-bg-opacity:1;background-color:rgb(13 13 13 / var(--tw-bg-opacity, 1))}.bg-\[\#1a1a1a\]{--tw-bg-opacity:1;background-color:rgb(26 26 26 / var(--tw-bg-opacity, 1))}.bg-black\/50{background-color:rgb(0 0 0 / 0.5)}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-blue-900\/50{background-color:rgb(30 58 138 / 0.5)}.bg-red-600{--tw-bg-opacity:1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.fill-current{fill:currentColor}.p-1{padding:0.25rem}.p-2{padding:0.5rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-1\.5{padding-top:0.375rem;padding-bottom:0.375rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.pr-3{padding-right:0.75rem}.pt-4{padding-top:1rem}.text-right{text-align:right}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-\[10px\]{font-size:10px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.uppercase{text-transform:uppercase}.leading-6{line-height:1.5rem}.tracking-wide{letter-spacing:0.025em}.tracking-wider{letter-spacing:0.05em}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-blue-300{--tw-text-opacity:1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.text-blue-400{--tw-text-opacity:1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-purple-300{--tw-text-opacity:1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.text-blue-200{--tw-text-opacity:1;color:rgb(191 219 254 / var(--tw-text-opacity, 1))}.opacity-0{opacity:0}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-green-900\/50{--tw-shadow-color:rgb(20 83 45 / 0.5);--tw-shadow:var(--tw-shadow-colored)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-300{transition-duration:300ms}.hover\:bg-blue-900\/30:hover{background-color:rgb(30 58 138 / 0.3)}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-700:hover{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-700\/50:hover{background-color:rgb(55 65 81 / 0.5)}.hover\:bg-green-500:hover{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-900\/30:hover{background-color:rgb(88 28 135 / 0.3)}.hover\:bg-yellow-500:hover{--tw-bg-opacity:1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-500:hover{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500:hover{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.hover\:text-blue-100:hover{--tw-text-opacity:1;color:rgb(219 234 254 / var(--tw-text-opacity, 1))}.hover\:text-gray-100:hover{--tw-text-opacity:1;color:rgb(243 244 246 / var(--tw-text-opacity, 1))}.hover\:text-purple-100:hover{--tw-text-opacity:1;color:rgb(243 232 255 / var(--tw-text-opacity, 1))}.hover\:text-red-400:hover{--tw-text-opacity:1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.active\:scale-95:active{--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:opacity-100{opacity:1}@media (min-width: 640px){.sm\:block{display:block}.sm\:inline{display:inline}.sm\:flex{display:flex}.sm\:hidden{display:none}}@media (min-width: 768px){.md\:flex{display:flex}.md\:hidden{display:none}.md\:w-1\/2{width:50%}.md\:flex-row{flex-direction:row}}@media (min-width: 1024px){.lg\:inline{display:inline}}</style></head>
<body class="bg-gray-900 text-white h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="bg-gray-800 border-b border-gray-700 h-14 flex items-center justify-between px-4 shrink-0">
        <div class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="code-2" class="lucide lucide-code-2 text-blue-400"><path d="m18 16 4-4-4-4"></path><path d="m6 8-4 4 4 4"></path><path d="m14.5 4-5 16"></path></svg>
            <span class="font-bold text-lg tracking-wide hidden sm:inline">Orbit Runner</span>
            <span class="font-bold text-lg tracking-wide sm:hidden">Orbit</span>
        </div>

        <div class="flex items-center gap-2">
            <!-- Mobile View Toggles -->
            <div class="flex md:hidden bg-gray-700 rounded-md p-1 mr-2">
                <button onclick="setView('editor')" id="btn-editor" class="p-2 rounded text-blue-400 bg-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="file-code" class="lucide lucide-file-code w-4 h-4"><path d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"></path><path d="M14 2v5a1 1 0 0 0 1 1h5"></path><path d="M10 12.5 8 15l2 2.5"></path><path d="m14 12.5 2 2.5-2 2.5"></path></svg>
                </button>
                <button onclick="setView('preview')" id="btn-preview" class="p-2 rounded text-gray-400 hover:text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="eye" class="lucide lucide-eye w-4 h-4"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"></path><circle cx="12" cy="12" r="3"></circle></svg>
                </button>
            </div>

            <button onclick="clearCode()" class="hidden sm:flex items-center gap-2 px-3 py-1.5 text-gray-300 hover:text-white hover:bg-gray-700 rounded transition-colors text-sm font-medium">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="trash-2" class="lucide lucide-trash-2 w-4 h-4"><path d="M10 11v6"></path><path d="M14 11v6"></path><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path><path d="M3 6h18"></path><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                <span class="hidden lg:inline">Clear</span>
            </button>

            <!-- Upload Files Button -->
            <button onclick="triggerSingleUpload()" class="flex items-center gap-2 px-3 py-1.5 text-gray-300 hover:text-white hover:bg-gray-700 rounded transition-colors text-sm font-medium" title="Upload Files or Zip">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="file-up" class="lucide lucide-file-up w-4 h-4"><path d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"></path><path d="M14 2v5a1 1 0 0 0 1 1h5"></path><path d="M12 12v6"></path><path d="m15 15-3-3-3 3"></path></svg>
                <span class="hidden lg:inline">Upload Files / Zip</span>
            </button>

            <!-- Upload Folder Button -->
            <button onclick="triggerUpload()" class="flex items-center gap-2 px-3 py-1.5 text-gray-300 hover:text-white hover:bg-gray-700 rounded transition-colors text-sm font-medium" title="Upload Folder">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="folder-up" class="lucide lucide-folder-up w-4 h-4"><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"></path><path d="M12 10v6"></path><path d="m9 13 3-3 3 3"></path></svg>
                <span class="hidden lg:inline">Upload Folder</span>
            </button>

            <button onclick="downloadApp()" class="hidden sm:flex items-center gap-2 px-3 py-1.5 text-blue-300 hover:text-blue-100 hover:bg-blue-900/30 rounded transition-colors text-sm font-medium border border-blue-900/50">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="save" class="lucide lucide-save w-4 h-4"><path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"></path><path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"></path><path d="M7 3v4a1 1 0 0 0 1 1h7"></path></svg>
                <span class="hidden lg:inline">Save Orbit</span>
            </button>

            <!-- Publish Button (New) -->
            <button onclick="showPublishModal()" class="hidden sm:flex items-center gap-2 px-3 py-1.5 text-purple-300 hover:text-purple-100 hover:bg-purple-900/30 rounded transition-colors text-sm font-medium border border-purple-900/50" title="Publish to Web">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="cloud-upload" class="lucide lucide-cloud-upload w-4 h-4"><path d="M12 13v8"></path><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"></path><path d="m8 17 4-4 4 4"></path></svg>
                <span class="hidden lg:inline">Publish</span>
            </button>

            <!-- Pop Out Button -->
            <button onclick="openAppInNewWindow()" class="hidden sm:flex items-center gap-2 px-3 py-1.5 text-gray-400 hover:text-gray-100 hover:bg-gray-700/50 rounded transition-colors text-sm font-medium" title="Open App in New Tab">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="external-link" class="lucide lucide-external-link w-4 h-4"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg>
                <span class="hidden lg:inline">Pop Out</span>
            </button>

            <!-- Run Button -->
            <button onclick="runCode(true)" class="flex items-center gap-2 px-4 py-1.5 bg-green-600 hover:bg-green-500 text-white rounded font-medium shadow-lg shadow-green-900/50 transition-all active:scale-95">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="play" class="lucide lucide-play w-4 h-4 fill-current"><path d="M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"></path></svg>
                Run
            </button>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-1 flex flex-col md:flex-row overflow-hidden relative">
        
        <!-- Editor Section -->
        <div id="editor-pane" class="w-full md:w-1/2 h-full flex border-r border-gray-700 relative bg-[#1e1e1e]">
            
            <!-- File Explorer Sidebar -->
            <div id="file-sidebar" class="w-48 bg-[#18181b] border-r border-gray-700 flex flex-col shrink-0">
                <div class="px-3 py-2 text-xs font-bold text-gray-500 uppercase tracking-wider border-b border-gray-800">
                    Explorer
                </div>
                <div id="file-list" class="flex-1 overflow-y-auto py-2"><div class="file-item active group">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="file-code" class="lucide lucide-file-code w-3 h-3 shrink-0"><path d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"></path><path d="M14 2v5a1 1 0 0 0 1 1h5"></path><path d="M10 12.5 8 15l2 2.5"></path><path d="m14 12.5 2 2.5-2 2.5"></path></svg>
                    <span class="truncate" title="hi.html">hi.html</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="x" onclick="deleteFile(event, 'hi.html')" class="lucide lucide-x w-3 h-3 ml-auto hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity shrink-0"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
                </div></div>
                <div class="p-2 border-t border-gray-800">
                    <button onclick="addNewFile()" class="w-full text-xs bg-gray-800 hover:bg-gray-700 text-gray-300 py-1 rounded border border-gray-700">
                        + New File
                    </button>
                </div>
            </div>

            <!-- Code Editor Area -->
            <div class="flex-1 flex flex-col min-w-0">
                <div class="flex items-center justify-between px-4 py-2 bg-[#252526] text-xs text-gray-400 select-none border-b border-[#333]">
                    <div class="flex items-center gap-3">
                        <span id="current-filename">hi.html</span>
                        <span class="text-gray-500 text-[10px]" id="file-type-badge">HTML</span>
                    </div>
                    <!-- View Full File Code Button (Hidden by default) -->
                    <button id="view-full-code-btn" onclick="forceLoadActiveFile()" class="hidden px-2 py-0.5 text-[10px] bg-yellow-600 hover:bg-yellow-500 text-white rounded transition-colors">
                        View full file code
                    </button>
                </div>
                
                <div class="flex-1 relative flex overflow-hidden">
                    <div id="line-numbers" class="w-12 bg-[#1e1e1e] text-gray-600 text-right pr-3 pt-4 text-sm font-mono leading-6 gutter h-full overflow-hidden hidden sm:block shrink-0"><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div><div>9</div><div>10</div><div>11</div><div>12</div><div>13</div><div>14</div><div>15</div><div>16</div><div>17</div><div>18</div><div>19</div><div>20</div><div>21</div><div>22</div><div>23</div><div>24</div><div>25</div><div>26</div><div>27</div><div>28</div><div>29</div><div>30</div><div>31</div><div>32</div><div>33</div><div>34</div><div>35</div><div>36</div><div>37</div><div>38</div><div>39</div><div>40</div><div>41</div><div>42</div><div>43</div><div>44</div><div>45</div><div>46</div><div>47</div><div>48</div><div>49</div><div>50</div><div>51</div><div>52</div><div>53</div><div>54</div><div>55</div><div>56</div><div>57</div><div>58</div><div>59</div><div>60</div><div>61</div><div>62</div><div>63</div><div>64</div><div>65</div><div>66</div><div>67</div><div>68</div><div>69</div><div>70</div><div>71</div><div>72</div><div>73</div><div>74</div><div>75</div><div>76</div><div>77</div><div>78</div><div>79</div><div>80</div><div>81</div><div>82</div><div>83</div><div>84</div><div>85</div><div>86</div><div>87</div><div>88</div><div>89</div><div>90</div><div>91</div><div>92</div><div>93</div><div>94</div><div>95</div><div>96</div><div>97</div><div>98</div><div>99</div><div>100</div><div>101</div><div>102</div><div>103</div><div>104</div><div>105</div><div>106</div><div>107</div><div>108</div><div>109</div><div>110</div><div>111</div><div>112</div><div>113</div><div>114</div><div>115</div><div>116</div><div>117</div><div>118</div><div>119</div><div>120</div><div>121</div><div>122</div><div>123</div><div>124</div><div>125</div><div>126</div><div>127</div><div>128</div><div>129</div><div>130</div><div>131</div><div>132</div><div>133</div><div>134</div><div>135</div><div>136</div><div>137</div><div>138</div><div>139</div><div>140</div><div>141</div><div>142</div><div>143</div><div>144</div><div>145</div><div>146</div><div>147</div><div>148</div><div>149</div><div>150</div><div>151</div><div>152</div><div>153</div><div>154</div><div>155</div><div>156</div><div>157</div><div>158</div><div>159</div><div>160</div><div>161</div><div>162</div><div>163</div><div>164</div><div>165</div><div>166</div><div>167</div><div>168</div><div>169</div><div>170</div><div>171</div><div>172</div><div>173</div><div>174</div><div>175</div><div>176</div><div>177</div><div>178</div><div>179</div><div>180</div><div>181</div><div>182</div><div>183</div><div>184</div><div>185</div><div>186</div><div>187</div><div>188</div><div>189</div><div>190</div><div>191</div><div>192</div><div>193</div><div>194</div><div>195</div><div>196</div><div>197</div><div>198</div><div>199</div><div>200</div><div>201</div><div>202</div><div>203</div><div>204</div><div>205</div><div>206</div><div>207</div><div>208</div><div>209</div><div>210</div><div>211</div><div>212</div><div>213</div><div>214</div><div>215</div><div>216</div><div>217</div><div>218</div><div>219</div><div>220</div><div>221</div><div>222</div><div>223</div><div>224</div><div>225</div><div>226</div><div>227</div><div>228</div><div>229</div><div>230</div><div>231</div><div>232</div><div>233</div><div>234</div><div>235</div><div>236</div><div>237</div><div>238</div><div>239</div><div>240</div><div>241</div><div>242</div><div>243</div><div>244</div><div>245</div><div>246</div><div>247</div><div>248</div><div>249</div><div>250</div><div>251</div><div>252</div><div>253</div><div>254</div><div>255</div><div>256</div><div>257</div><div>258</div><div>259</div><div>260</div><div>261</div><div>262</div><div>263</div><div>264</div><div>265</div><div>266</div><div>267</div><div>268</div><div>269</div><div>270</div><div>271</div><div>272</div><div>273</div><div>274</div><div>275</div><div>276</div><div>277</div><div>278</div><div>279</div><div>280</div><div>281</div><div>282</div><div>283</div><div>284</div><div>285</div><div>286</div><div>287</div><div>288</div><div>289</div><div>290</div><div>291</div><div>292</div><div>293</div><div>294</div><div>295</div><div>296</div><div>297</div><div>298</div><div>299</div><div>300</div><div>301</div><div>302</div><div>303</div><div>304</div><div>305</div><div>306</div><div>307</div><div>308</div><div>309</div><div>310</div><div>311</div><div>312</div><div>313</div><div>314</div><div>315</div><div>316</div><div>317</div><div>318</div><div>319</div><div>320</div><div>321</div><div>322</div><div>323</div><div>324</div><div>325</div><div>326</div><div>327</div><div>328</div><div>329</div><div>330</div><div>331</div><div>332</div><div>333</div><div>334</div><div>335</div><div>336</div><div>337</div><div>338</div><div>339</div><div>340</div><div>341</div><div>342</div><div>343</div><div>344</div><div>345</div><div>346</div><div>347</div><div>348</div><div>349</div><div>350</div><div>351</div><div>352</div><div>353</div><div>354</div><div>355</div><div>356</div><div>357</div><div>358</div><div>359</div><div>360</div><div>361</div><div>362</div><div>363</div><div>364</div><div>365</div><div>366</div><div>367</div><div>368</div><div>369</div><div>370</div><div>371</div><div>372</div><div>373</div><div>374</div><div>375</div><div>376</div><div>377</div><div>378</div><div>379</div><div>380</div><div>381</div><div>382</div><div>383</div><div>384</div><div>385</div><div>386</div><div>387</div><div>388</div><div>389</div><div>390</div><div>391</div><div>392</div><div>393</div><div>394</div><div>395</div><div>396</div><div>397</div><div>398</div><div>399</div><div>400</div><div>401</div><div>402</div><div>403</div><div>404</div><div>405</div><div>406</div><div>407</div><div>408</div><div>409</div><div>410</div><div>411</div><div>412</div><div>413</div><div>414</div><div>415</div><div>416</div><div>417</div><div>418</div><div>419</div><div>420</div><div>421</div><div>422</div><div>423</div><div>424</div><div>425</div><div>426</div><div>427</div><div>428</div><div>429</div><div>430</div><div>431</div><div>432</div><div>433</div><div>434</div><div>435</div><div>436</div><div>437</div><div>438</div><div>439</div><div>440</div><div>441</div><div>442</div><div>443</div><div>444</div><div>445</div><div>446</div><div>447</div><div>448</div><div>449</div><div>450</div><div>451</div><div>452</div><div>453</div><div>454</div><div>455</div><div>456</div><div>457</div><div>458</div><div>459</div><div>460</div><div>461</div><div>462</div><div>463</div><div>464</div><div>465</div><div>466</div><div>467</div><div>468</div><div>469</div><div>470</div><div>471</div><div>472</div><div>473</div><div>474</div><div>475</div><div>476</div><div>477</div><div>478</div><div>479</div><div>480</div><div>481</div><div>482</div><div>483</div><div>484</div><div>485</div><div>486</div><div>487</div><div>488</div><div>489</div><div>490</div><div>491</div><div>492</div><div>493</div><div>494</div><div>495</div><div>496</div><div>497</div><div>498</div><div>499</div><div>500</div><div>501</div><div>502</div><div>503</div><div>504</div><div>505</div><div>506</div><div>507</div><div>508</div><div>509</div><div>510</div><div>511</div><div>512</div><div>513</div><div>514</div><div>515</div><div>516</div><div>517</div><div>518</div><div>519</div><div>520</div><div>521</div><div>522</div><div>523</div><div>524</div><div>525</div><div>526</div><div>527</div><div>528</div><div>529</div><div>530</div><div>531</div><div>532</div><div>533</div><div>534</div><div>535</div><div>536</div><div>537</div><div>538</div><div>539</div><div>540</div><div>541</div><div>542</div><div>543</div><div>544</div><div>545</div><div>546</div><div>547</div><div>548</div><div>549</div><div>550</div><div>551</div><div>552</div><div>553</div><div>554</div><div>555</div><div>556</div><div>557</div><div>558</div><div>559</div><div>560</div><div>561</div><div>562</div><div>563</div><div>564</div><div>565</div><div>566</div><div>567</div><div>568</div><div>569</div><div>570</div><div>571</div><div>572</div><div>573</div><div>574</div><div>575</div><div>576</div><div>577</div><div>578</div><div>579</div><div>580</div><div>581</div><div>582</div><div>583</div><div>584</div><div>585</div><div>586</div><div>587</div><div>588</div><div>589</div><div>590</div><div>591</div><div>592</div><div>593</div><div>594</div><div>595</div><div>596</div><div>597</div><div>598</div><div>599</div><div>600</div><div>601</div><div>602</div><div>603</div><div>604</div><div>605</div><div>606</div><div>607</div><div>608</div><div>609</div><div>610</div><div>611</div><div>612</div><div>613</div><div>614</div><div>615</div><div>616</div><div>617</div><div>618</div><div>619</div><div>620</div><div>621</div><div>622</div><div>623</div><div>624</div><div>625</div><div>626</div><div>627</div><div>628</div><div>629</div><div>630</div><div>631</div><div>632</div><div>633</div><div>634</div><div>635</div><div>636</div><div>637</div><div>638</div><div>639</div><div>640</div><div>641</div><div>642</div><div>643</div><div>644</div><div>645</div><div>646</div><div>647</div><div>648</div><div>649</div><div>650</div><div>651</div><div>652</div><div>653</div><div>654</div><div>655</div><div>656</div><div>657</div><div>658</div><div>659</div><div>660</div><div>661</div><div>662</div><div>663</div><div>664</div><div>665</div><div>666</div><div>667</div><div>668</div><div>669</div><div>670</div><div>671</div><div>672</div><div>673</div><div>674</div><div>675</div><div>676</div><div>677</div><div>678</div><div>679</div><div>680</div><div>681</div><div>682</div><div>683</div><div>684</div><div>685</div><div>686</div><div>687</div><div>688</div><div>689</div><div>690</div><div>691</div><div>692</div><div>693</div><div>694</div><div>695</div><div>696</div><div>697</div><div>698</div><div>699</div><div>700</div><div>701</div><div>702</div><div>703</div><div>704</div><div>705</div><div>706</div><div>707</div><div>708</div><div>709</div><div>710</div><div>711</div><div>712</div><div>713</div><div>714</div><div>715</div><div>716</div><div>717</div><div>718</div><div>719</div><div>720</div><div>721</div><div>722</div><div>723</div><div>724</div><div>725</div><div>726</div><div>727</div><div>728</div><div>729</div><div>730</div><div>731</div><div>732</div><div>733</div><div>734</div><div>735</div><div>736</div><div>737</div><div>738</div><div>739</div><div>740</div><div>741</div><div>742</div><div>743</div><div>744</div><div>745</div><div>746</div><div>747</div><div>748</div><div>749</div><div>750</div><div>751</div><div>752</div><div>753</div><div>754</div><div>755</div><div>756</div><div>757</div><div>758</div><div>759</div><div>760</div><div>761</div><div>762</div><div>763</div><div>764</div><div>765</div><div>766</div><div>767</div><div>768</div><div>769</div><div>770</div><div>771</div><div>772</div><div>773</div><div>774</div><div>775</div><div>776</div><div>777</div><div>778</div><div>779</div><div>780</div><div>781</div><div>782</div><div>783</div><div>784</div><div>785</div><div>786</div><div>787</div><div>788</div><div>789</div><div>790</div><div>791</div><div>792</div><div>793</div><div>794</div><div>795</div><div>796</div><div>797</div><div>798</div><div>799</div><div>800</div><div>801</div><div>802</div><div>803</div><div>804</div><div>805</div><div>806</div><div>807</div><div>808</div><div>809</div><div>810</div><div>811</div><div>812</div><div>813</div><div>814</div><div>815</div><div>816</div><div>817</div><div>818</div><div>819</div><div>820</div><div>821</div><div>822</div><div>823</div><div>824</div><div>825</div><div>826</div><div>827</div><div>828</div><div>829</div><div>830</div><div>831</div><div>832</div><div>833</div><div>834</div><div>835</div><div>836</div><div>837</div><div>838</div><div>839</div><div>840</div><div>841</div><div>842</div><div>843</div><div>844</div><div>845</div><div>846</div><div>847</div><div>848</div><div>849</div><div>850</div><div>851</div><div>852</div><div>853</div><div>854</div><div>855</div><div>856</div><div>857</div><div>858</div><div>859</div><div>860</div><div>861</div><div>862</div><div>863</div><div>864</div><div>865</div><div>866</div><div>867</div><div>868</div><div>869</div><div>870</div><div>871</div><div>872</div><div>873</div><div>874</div><div>875</div><div>876</div><div>877</div><div>878</div><div>879</div><div>880</div><div>881</div><div>882</div><div>883</div><div>884</div><div>885</div><div>886</div><div>887</div><div>888</div><div>889</div><div>890</div><div>891</div><div>892</div><div>893</div><div>894</div><div>895</div><div>896</div><div>897</div><div>898</div><div>899</div><div>900</div><div>901</div><div>902</div><div>903</div><div>904</div><div>905</div><div>906</div><div>907</div><div>908</div><div>909</div><div>910</div><div>911</div><div>912</div><div>913</div><div>914</div><div>915</div><div>916</div><div>917</div><div>918</div><div>919</div><div>920</div><div>921</div><div>922</div><div>923</div><div>924</div><div>925</div><div>926</div><div>927</div><div>928</div><div>929</div><div>930</div><div>931</div><div>932</div><div>933</div><div>934</div><div>935</div><div>936</div><div>937</div><div>938</div><div>939</div><div>940</div><div>941</div><div>942</div><div>943</div><div>944</div><div>945</div><div>946</div><div>947</div><div>948</div><div>949</div><div>950</div><div>951</div><div>952</div><div>953</div><div>954</div><div>955</div><div>956</div><div>957</div><div>958</div><div>959</div><div>960</div><div>961</div><div>962</div><div>963</div></div>
                    <textarea id="code-editor" class="editor-textarea flex-1 w-full h-full bg-[#1e1e1e] text-gray-100 p-4 border-none text-sm leading-6" placeholder="Select a file to edit..." spellcheck="false" oninput="handleEditorInput()" onscroll="syncScroll()"></textarea>
                </div>
            </div>
        </div>

        <!-- Preview Section -->
        <div id="preview-pane" class="w-full md:w-1/2 h-full flex flex-col bg-white md:flex">
            <div class="flex items-center justify-between px-4 py-2 bg-gray-100 border-b border-gray-200 text-xs text-gray-500 select-none">
                <!-- Navigation Controls -->
                <div class="flex items-center gap-2">
                    <button onclick="previewBack()" class="p-1 hover:bg-gray-200 rounded text-gray-600 transition-colors" title="Back">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="arrow-left" class="lucide lucide-arrow-left w-3.5 h-3.5"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>
                    </button>
                    <button onclick="previewForward()" class="p-1 hover:bg-gray-200 rounded text-gray-600 transition-colors" title="Forward">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="arrow-right" class="lucide lucide-arrow-right w-3.5 h-3.5"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg>
                    </button>
                    <button onclick="previewRefresh()" class="p-1 hover:bg-gray-200 rounded text-gray-600 transition-colors" title="Refresh">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="refresh-cw" class="lucide lucide-refresh-cw w-3.5 h-3.5"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></svg>
                    </button>
                </div>
                
                <div class="flex items-center gap-3">
                    <span>Browser Preview</span>
                    <button onclick="toggleFullscreen()" class="p-1 hover:bg-gray-200 rounded text-gray-500 transition-colors" title="Toggle Fullscreen">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="maximize-2" class="lucide lucide-maximize-2 w-3.5 h-3.5"><path d="M15 3h6v6"></path><path d="m21 3-7 7"></path><path d="m3 21 7-7"></path><path d="M9 21H3v-6"></path></svg>
                    </button>
                </div>
            </div>
            <div class="flex-1 relative bg-white">
                <iframe id="preview-frame" class="w-full h-full border-none" allow="fullscreen" sandbox="allow-scripts allow-modals allow-forms allow-same-origin allow-popups" src="about:blank"></iframe>
            </div>
        </div>
    </main>

    <!-- Console Section -->
    <div id="console-pane" class="h-48 border-t border-gray-700 bg-[#0d0d0d] flex flex-col shrink-0 transition-all duration-300">
        <div class="flex items-center justify-between px-4 py-1 bg-[#1a1a1a] border-b border-gray-800 text-xs cursor-pointer" onclick="toggleConsole()">
            <div class="flex items-center gap-2 text-gray-400 font-mono">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="terminal" class="lucide lucide-terminal w-3 h-3"><path d="M12 19h8"></path><path d="m4 17 6-6-6-6"></path></svg>
                <span>Console</span>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="clearConsole(event)" class="hover:text-white text-gray-500" title="Clear Console">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="ban" class="lucide lucide-ban w-3 h-3"><path d="M4.929 4.929 19.07 19.071"></path><circle cx="12" cy="12" r="10"></circle></svg>
                </button>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-down" id="console-chevron" class="lucide lucide-chevron-down w-3 h-3 text-gray-500"><path d="m6 9 6 6 6-6"></path></svg>
            </div>
        </div>
        <div id="console-output" class="flex-1 overflow-y-auto p-2 font-mono text-xs text-gray-300"></div>
    </div>

    <!-- Hidden File Inputs -->
    <input type="file" id="file-input" webkitdirectory="" directory="" multiple="" class="hidden" onchange="handleFolderUpload(this)">
    <!-- Updated accept attribute to include .zip -->
    <input type="file" id="single-file-input" multiple="" accept=".html,.htm,.css,.js,.txt,.png,.jpg,.jpeg,.gif,.svg,.webp,.zip" class="hidden" onchange="handleFolderUpload(this)">

    <!-- Clear Confirmation Modal -->
    <div id="clear-modal" class="fixed inset-0 bg-black/50 z-50 items-center justify-center backdrop-blur-sm hidden">
        <div class="bg-gray-800 border border-gray-700 p-6 rounded-lg shadow-xl max-w-sm w-full mx-4">
            <h3 class="text-lg font-bold text-white mb-2">Clear Project?</h3>
            <p class="text-gray-400 mb-6 text-sm">This will remove all files. This action cannot be undone.</p>
            <div class="flex justify-end gap-3">
                <button onclick="closeModal()" class="px-4 py-2 text-gray-300 hover:text-white font-medium transition-colors text-sm">Cancel</button>
                <button onclick="confirmClear()" class="px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded font-medium transition-colors text-sm">Clear All</button>
            </div>
        </div>
    </div>

    <!-- New File Modal -->
    <div id="new-file-modal" class="fixed inset-0 bg-black/50 z-50 items-center justify-center backdrop-blur-sm hidden">
        <div class="bg-gray-800 border border-gray-700 p-6 rounded-lg shadow-xl max-w-sm w-full mx-4">
            <h3 class="text-lg font-bold text-white mb-2">New File</h3>
            <input type="text" id="new-filename-input" class="w-full bg-gray-900 border border-gray-700 text-white px-3 py-2 rounded mb-4 text-sm" placeholder="e.g., page2.html">
            <div class="flex justify-end gap-3">
                <button onclick="closeNewFileModal()" class="px-4 py-2 text-gray-300 hover:text-white font-medium transition-colors text-sm">Cancel</button>
                <button onclick="confirmNewFile()" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded font-medium transition-colors text-sm">Create</button>
            </div>
        </div>
    </div>

    <!-- Message Modal -->
    <div id="message-modal" class="fixed inset-0 bg-black/50 z-50 items-center justify-center backdrop-blur-sm hidden">
        <div class="bg-gray-800 border border-gray-700 p-6 rounded-lg shadow-xl max-w-sm w-full mx-4">
            <h3 id="msg-title" class="text-lg font-bold text-white mb-2">Temporary Session</h3>
            <p id="msg-text" class="text-gray-400 mb-6 text-sm whitespace-pre-line">You are opening a temporary window.<br><br>This link CANNOT be bookmarked. To save a permanent version, please use the "Save Orbit" button.</p>
            <div class="flex justify-end">
                <button onclick="closeMessageModal()" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded font-medium transition-colors text-sm">OK</button>
            </div>
        </div>
    </div>

    <!-- Publish Guide Modal (New) -->
    <div id="publish-modal" class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center backdrop-blur-sm">
        <div class="bg-gray-800 border border-gray-700 p-6 rounded-lg shadow-xl max-w-md w-full mx-4">
            <h3 class="text-lg font-bold text-white mb-4">Make it a Real Website</h3>
            <p class="text-gray-300 text-sm mb-4">
                Since I am an AI, I can't host the website for you, but you can do it for free in 3 steps!
            </p>
            <div class="space-y-3 text-sm text-gray-400 mb-6">
                <div class="flex gap-3">
                    <span class="bg-blue-900/50 text-blue-200 w-6 h-6 flex items-center justify-center rounded-full shrink-0 text-xs font-bold">1</span>
                    <p>Click the <span class="text-blue-300 font-bold"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="save" class="lucide lucide-save inline w-3 h-3"><path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"></path><path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"></path><path d="M7 3v4a1 1 0 0 0 1 1h7"></path></svg> Save Orbit</span> button above to download this app as an HTML file.</p>
                </div>
                <div class="flex gap-3">
                    <span class="bg-blue-900/50 text-blue-200 w-6 h-6 flex items-center justify-center rounded-full shrink-0 text-xs font-bold">2</span>
                    <p>Go to a free hosting site like <b>Netlify Drop</b>.</p>
                </div>
                <div class="flex gap-3">
                    <span class="bg-blue-900/50 text-blue-200 w-6 h-6 flex items-center justify-center rounded-full shrink-0 text-xs font-bold">3</span>
                    <p>Upload your file there. They will give you a real URL (like <code>https://my-app.netlify.app</code>) that you can bookmark!</p>
                </div>
            </div>
            <div class="flex justify-end">
                <button onclick="closePublishModal()" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded font-medium transition-colors text-sm">Got it</button>
            </div>
        </div>
    </div>

    <!-- Upload Confirmation Modal -->
    <div id="upload-modal" class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center backdrop-blur-sm">
        <div class="bg-gray-800 border border-gray-700 p-6 rounded-lg shadow-xl max-w-sm w-full mx-4">
            <h3 class="text-lg font-bold text-white mb-2">Upload Files</h3>
            <p class="text-gray-400 mb-6 text-sm">How would you like to handle these files?</p>
            <div class="flex justify-end gap-3">
                <button onclick="closeUploadModal()" class="px-4 py-2 text-gray-300 hover:text-white font-medium transition-colors text-sm">Cancel</button>
                <button onclick="confirmUpload(true)" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded font-medium transition-colors text-sm">Merge</button>
                <button onclick="confirmUpload(false)" class="px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded font-medium transition-colors text-sm">Replace All</button>
            </div>
        </div>
    </div>

    <script>
        // --- Initialization ---
        const defaultFiles = {
            'index.html': {
                content: `<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Orbit Code Runner</h1>
        <p>This is a starter template.</p>
        <button onclick="showAlert()">Click Me</button>
    </div>
    <script src="script.js"><\/script>
</body>
</html>`,
                type: 'text/html'
            },
            'style.css': {
                content: `body {
    font-family: sans-serif;
    background: #1e1e1e;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
}
.container {
    text-align: center;
    background: #2d2d2d;
    padding: 2rem;
    border-radius: 8px;
    border: 1px solid #3d3d3d;
}
button {
    margin-top: 1rem;
    padding: 0.5rem 1rem;
    background: #3b82f6;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
button:hover { background: #2563eb; }`,
                type: 'text/css'
            },
            'script.js': {
                content: `function showAlert() {
    console.log("Hello from Orbit!");
    alert("System operational!");
}`,
                type: 'text/javascript'
            }
        };

        // State
        let projectFiles = {};
        let activeFile = 'index.html';
        let isConsoleCollapsed = false;
        let forceLoadLargeFile = false; // State to track if user chose to view large file

        // Elements
        let editor, lineNumbers, iframe, consoleOutput, consolePane, consoleChevron, fileList;
        let clearModal, messageModal, newFileModal, uploadModal, publishModal;
        let msgTitle, msgText, newFilenameInput;
        let pendingUploadFiles = null;
        let pendingUploadInput = null;
        let viewFullCodeBtn;

        window.onload = function() {
            if (typeof lucide !== 'undefined') lucide.createIcons();

            editor = document.getElementById('code-editor');
            lineNumbers = document.getElementById('line-numbers');
            iframe = document.getElementById('preview-frame');
            consoleOutput = document.getElementById('console-output');
            consolePane = document.getElementById('console-pane');
            consoleChevron = document.getElementById('console-chevron');
            fileList = document.getElementById('file-list');
            viewFullCodeBtn = document.getElementById('view-full-code-btn');
            
            clearModal = document.getElementById('clear-modal');
            messageModal = document.getElementById('message-modal');
            newFileModal = document.getElementById('new-file-modal');
            uploadModal = document.getElementById('upload-modal');
            publishModal = document.getElementById('publish-modal');
            
            msgTitle = document.getElementById('msg-title');
            msgText = document.getElementById('msg-text');
            newFilenameInput = document.getElementById('new-filename-input');

            // Initialize State
            if (window.__PRELOADED_FILES__) {
                projectFiles = window.__PRELOADED_FILES__;
                activeFile = window.__PRELOADED_ACTIVE__ || 'index.html';
                logToConsole('info', 'Restored session from previous window.');
            } else {
                try {
                    const saved = localStorage.getItem('orbit-files');
                    if (saved) {
                        try {
                            projectFiles = JSON.parse(saved);
                        } catch(e) { projectFiles = JSON.parse(JSON.stringify(defaultFiles)); }
                    } else {
                        projectFiles = JSON.parse(JSON.stringify(defaultFiles));
                    }
                } catch(e) {
                    console.warn('LocalStorage access denied or unavailable.');
                    projectFiles = JSON.parse(JSON.stringify(defaultFiles));
                }
            }

            if (!Object.keys(projectFiles).length) {
                projectFiles = JSON.parse(JSON.stringify(defaultFiles));
            }
            if (!projectFiles[activeFile]) {
                activeFile = Object.keys(projectFiles)[0];
            }

            setupEditorEvents();
            renderFileList();
            loadActiveFile();
            runCode(false);
        };

        // --- File Management ---

        function renderFileList() {
            fileList.innerHTML = '';
            // Sort files but keep index.html at top if preferred, or just alphabetical
            Object.keys(projectFiles).sort().forEach(filename => {
                const item = document.createElement('div');
                item.className = `file-item ${filename === activeFile ? 'active' : ''}`;
                item.onclick = () => switchFile(filename);
                
                let icon = 'file';
                if (filename.endsWith('.html')) icon = 'file-code';
                else if (filename.endsWith('.css')) icon = 'palette';
                else if (filename.endsWith('.js')) icon = 'file-json';
                else if (filename.match(/\.(png|jpg|jpeg|gif|svg|webp|zip)$/i)) icon = 'image';

                item.innerHTML = `
                    <i data-lucide="${icon}" class="w-3 h-3 shrink-0"></i>
                    <span class="truncate" title="${filename}">${filename}</span>
                    <i onclick="deleteFile(event, '${filename}')" data-lucide="x" class="w-3 h-3 ml-auto hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity shrink-0"></i>
                `;
                item.classList.add('group');
                fileList.appendChild(item);
            });
            lucide.createIcons();
        }

        function switchFile(filename) {
            // Only save content if the editor was enabled (not in image/large file mode)
            if (projectFiles[activeFile] && !editor.disabled && !editor.readOnly) {
                projectFiles[activeFile].content = editor.value;
            }
            activeFile = filename;
            forceLoadLargeFile = false; // Reset large file state on switch
            loadActiveFile();
            renderFileList();
        }

        function loadActiveFile() {
            const file = projectFiles[activeFile];
            document.getElementById('current-filename').textContent = activeFile;
            
            // File Type Badge
            let type = 'FILE';
            if (activeFile.endsWith('.html')) type = 'HTML';
            else if (activeFile.endsWith('.css')) type = 'CSS';
            else if (activeFile.endsWith('.js')) type = 'JS';
            else if (file.type && file.type.startsWith('image/')) type = 'IMG';
            document.getElementById('file-type-badge').textContent = type;

            viewFullCodeBtn.classList.add('hidden'); // Hide by default
            editor.readOnly = false;
            editor.disabled = false;

            // Handle Images
            if (file.type && file.type.startsWith('image/')) {
                editor.value = "[Image Binary Data - View in Preview]";
                editor.readOnly = true;
                updateLineNumbers();
                return;
            }

            // Handle Text Files
            const content = file.content || '';
            const lineCount = content.split('\n').length;

            // PERFORMANCE OPTIMIZATION: Check line count
            if (lineCount >= 1000 && !forceLoadLargeFile) {
                editor.value = `\n\n\n\n      ---------------------------------------------------\n      FILE IS TOO LARGE TO DISPLAY (${lineCount} lines)\n      ---------------------------------------------------\n\n      This file is hidden to prevent lag on your device.\n      Click "View full file code" above to load it anyway.`;
                editor.readOnly = true;
                viewFullCodeBtn.classList.remove('hidden');
                updateLineNumbers();
                return;
            }

            editor.value = content;
            updateLineNumbers();
            
            try {
                localStorage.setItem('orbit-files', JSON.stringify(projectFiles));
            } catch(e) {}
        }

        function forceLoadActiveFile() {
            forceLoadLargeFile = true;
            loadActiveFile();
        }

        function handleEditorInput() {
            if (projectFiles[activeFile] && !editor.disabled && !editor.readOnly) {
                projectFiles[activeFile].content = editor.value;
                updateLineNumbers();
                try {
                    localStorage.setItem('orbit-files', JSON.stringify(projectFiles));
                } catch(e) {}
            }
        }

        function addNewFile() {
            newFilenameInput.value = '';
            newFileModal.classList.remove('hidden');
            newFileModal.classList.add('flex');
            newFilenameInput.focus();
        }

        function closeNewFileModal() {
            newFileModal.classList.add('hidden');
            newFileModal.classList.remove('flex');
        }

        function confirmNewFile() {
            const name = newFilenameInput.value.trim();
            if (!name) return;
            if (projectFiles[name]) {
                alert('File already exists!');
                return;
            }
            projectFiles[name] = { content: '', type: 'text/plain' };
            closeNewFileModal();
            switchFile(name);
        }

        function deleteFile(e, filename) {
            e.stopPropagation();
            if (confirm(`Delete ${filename}?`)) {
                delete projectFiles[filename];
                if (activeFile === filename) {
                    activeFile = Object.keys(projectFiles)[0] || '';
                }
                renderFileList();
                if(activeFile) loadActiveFile();
            }
        }

        // --- Core Run Logic ---

        function runCode(openInNewTab = false) {
            const blobMap = {};
            const keys = Object.keys(projectFiles);

            // 1. First Pass: Create Blobs / URLs
            keys.forEach(filename => {
                const file = projectFiles[filename];
                
                if (file.type && file.type.startsWith('image/')) {
                    blobMap[filename] = file.content;
                } else {
                    let mime = 'text/plain';
                    if (filename.endsWith('.html')) mime = 'text/html';
                    else if (filename.endsWith('.css')) mime = 'text/css';
                    else if (filename.endsWith('.js')) mime = 'application/javascript';
                    
                    const blob = new Blob([file.content], { type: mime });
                    blobMap[filename] = URL.createObjectURL(blob);
                }
            });

            const consoleInterceptor = `
                <script>
                    (function(){
                        const send = (type, args) => {
                            try {
                                const msg = args.map(arg => {
                                    if (typeof arg === 'object') return JSON.stringify(arg);
                                    return String(arg);
                                }).join(' ');
                                const target = window.opener || window.parent;
                                if (target) {
                                    target.postMessage({source: 'orbit-runner', type, message: msg}, '*');
                                }
                            } catch (e) {
                                console.error('Orbit Logger Error:', e);
                            }
                        };
                        const originalLog = console.log;
                        const originalWarn = console.warn;
                        const originalError = console.error;
                        console.log = (...args) => { send('info', args); originalLog.apply(console, args); };
                        console.warn = (...args) => { send('warn', args); originalWarn.apply(console, args); };
                        console.error = (...args) => { send('error', args); originalError.apply(console, args); };
                        window.onerror = (msg, url, line) => { send('error', [msg + ' (Line: ' + line + ')']); };
                    })();
                <\/script>
            `;

            const finalBlobUrls = {};
            const escapeRegExp = (string) => string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');

            // 2. Second Pass: Link Files
            keys.forEach(filename => {
                const file = projectFiles[filename];
                
                if (file.type && !file.type.startsWith('image/') && (filename.endsWith('.html') || filename.endsWith('.css') || filename.endsWith('.js'))) {
                    let content = file.content;
                    
                    if (filename.endsWith('.html')) {
                        if (content.includes('<head>')) {
                            content = content.replace('<head>', '<head>' + consoleInterceptor);
                        } else {
                            content = consoleInterceptor + content;
                        }
                    }

                    keys.forEach(targetFile => {
                        if (targetFile === filename) return;
                        
                        const blobUrl = blobMap[targetFile];
                        const pattern = new RegExp(`(href|src|action|url)\\s*=\\s*["']\\s*\\.?\\/?${escapeRegExp(targetFile)}\\s*["']`, 'gi');
                        
                        content = content.replace(pattern, (match, attr) => {
                            return `${attr}="${blobUrl}"`;
                        });
                        
                        if (filename.endsWith('.css') || filename.endsWith('.html')) {
                             const cssPattern = new RegExp(`url\\(\\s*["']?\\s*\\.?\\/?${escapeRegExp(targetFile)}\\s*["']?\\s*\\)`, 'gi');
                             content = content.replace(cssPattern, `url("${blobUrl}")`);
                        }
                    });

                    let mime = 'text/plain';
                    if (filename.endsWith('.html')) mime = 'text/html';
                    else if (filename.endsWith('.css')) mime = 'text/css';
                    else if (filename.endsWith('.js')) mime = 'application/javascript';
                    
                    const newBlob = new Blob([content], { type: mime });
                    finalBlobUrls[filename] = URL.createObjectURL(newBlob);
                } else {
                    finalBlobUrls[filename] = blobMap[filename];
                }
            });

            // 3. Determine Entry Point
            let entryPoint = activeFile.endsWith('.html') ? activeFile : 'index.html';
            if (!finalBlobUrls[entryPoint]) {
                entryPoint = keys.find(k => k.endsWith('.html'));
            }

            if (!entryPoint && activeFile.endsWith('.js')) {
                const jsContent = projectFiles[activeFile].content;
                const wrappedContent = `<!DOCTYPE html><html><head><title>JS Runner</title></head><body>${consoleInterceptor}<script>try{${jsContent}}catch(e){console.error(e.message);}<\/script></body></html>`;
                const blob = new Blob([wrappedContent], { type: 'text/html' });
                const blobUrl = URL.createObjectURL(blob);
                
                consoleOutput.innerHTML = '';
                iframe.src = blobUrl;
                if (openInNewTab) window.open(blobUrl, '_blank');
                return;
            }

            if (!entryPoint && activeFile.endsWith('.css')) {
                const cssContent = projectFiles[activeFile].content;
                const wrappedContent = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>CSS Preview</title><style>body{padding:20px;font-family:sans-serif;}${cssContent}</style></head><body><h1>CSS Preview</h1><p>Previewing styling for ${activeFile}</p><button>Button</button><input placeholder="Input"></body></html>`;
                const blob = new Blob([wrappedContent], { type: 'text/html' });
                const blobUrl = URL.createObjectURL(blob);
                
                consoleOutput.innerHTML = '';
                iframe.src = blobUrl;
                if (openInNewTab) window.open(blobUrl, '_blank');
                return;
            }

            if (entryPoint && finalBlobUrls[entryPoint]) {
                consoleOutput.innerHTML = ''; 
                iframe.src = finalBlobUrls[entryPoint];
                if (openInNewTab) window.open(finalBlobUrls[entryPoint], '_blank');
            } else {
                consoleOutput.innerHTML = '<div class="log-entry log-error">No entry point found. Create an .html file.</div>';
            }
        }

        // --- Upload Logic ---

        function triggerUpload() {
            document.getElementById('file-input').click();
        }

        function triggerSingleUpload() {
            document.getElementById('single-file-input').click();
        }

        function handleFolderUpload(input) {
            const files = input.files;
            if (!files || files.length === 0) return;

            pendingUploadFiles = files;
            pendingUploadInput = input;

            if (uploadModal) {
                uploadModal.classList.remove('hidden');
                uploadModal.classList.add('flex');
            }
        }

        function closeUploadModal() {
            if (uploadModal) {
                uploadModal.classList.add('hidden');
                uploadModal.classList.remove('flex');
            }
            if (pendingUploadInput) {
                pendingUploadInput.value = '';
                pendingUploadInput = null;
                pendingUploadFiles = null;
            }
        }

        async function confirmUpload(isMerge) {
            if (!pendingUploadFiles) return;

            if (uploadModal) {
                uploadModal.classList.add('hidden');
                uploadModal.classList.remove('flex');
            }

            if (!isMerge) {
                projectFiles = {}; 
                activeFile = '';
            }

            const files = Array.from(pendingUploadFiles);
            let processedCount = 0;
            const totalToProcess = files.length;
            
            // Log for debugging
            console.log(`Starting processing of ${totalToProcess} files`);

            for (const file of files) {
                // ZIP Handling
                if (file.name.endsWith('.zip')) {
                    try {
                        logToConsole('info', `Unzipping ${file.name}...`);
                        const zip = await JSZip.loadAsync(file);
                        
                        // Extract files from zip
                        for (const [relativePath, zipEntry] of Object.entries(zip.files)) {
                            if (zipEntry.dir) continue; // Skip directories

                            // Determine type
                            const isImage = relativePath.match(/\.(png|jpg|jpeg|gif|svg|webp)$/i);
                            const content = isImage 
                                ? await zipEntry.async("base64") 
                                : await zipEntry.async("string");
                            
                            // For images, we need to add the data prefix
                            const finalContent = isImage 
                                ? `data:image/${relativePath.split('.').pop()};base64,${content}`
                                : content;

                            const type = isImage ? `image/${relativePath.split('.').pop()}` : 'text/plain';

                            projectFiles[relativePath] = {
                                content: finalContent,
                                type: type
                            };
                        }
                        logToConsole('info', `Extracted contents of ${file.name}`);
                    } catch (e) {
                        logToConsole('error', `Failed to unzip ${file.name}: ${e.message}`);
                    }
                } 
                // Standard File Handling
                else {
                    await new Promise((resolve) => {
                        const reader = new FileReader();
                        let filename = file.name;

                        // Folder structure from folder upload
                        if (file.webkitRelativePath && file.webkitRelativePath.includes('/')) {
                            const parts = file.webkitRelativePath.split('/');
                            if (parts.length > 1) {
                                filename = parts.slice(1).join('/');
                            }
                        }

                        reader.onload = function(e) {
                            projectFiles[filename] = {
                                content: e.target.result,
                                type: file.type || 'text/plain'
                            };
                            resolve();
                        };
                        
                        if (file.type.startsWith('image/')) {
                            reader.readAsDataURL(file);
                        } else {
                            reader.readAsText(file);
                        }
                    });
                }
                
                processedCount++;
            }
            
            // All done
            renderFileList();
            
            if (!activeFile || !projectFiles[activeFile]) {
                if (projectFiles['index.html']) switchFile('index.html');
                else switchFile(Object.keys(projectFiles)[0]);
            } else {
                loadActiveFile();
            }
            
            runCode(false); 
            logToConsole('info', `Finished processing uploads.`);
            
            if (pendingUploadInput) pendingUploadInput.value = '';
            pendingUploadInput = null;
            pendingUploadFiles = null;
        }

        // --- Preview Navigation ---
        function previewBack() {
            try { iframe.contentWindow.history.back(); } catch(e) {}
        }
        function previewForward() {
            try { iframe.contentWindow.history.forward(); } catch(e) {}
        }
        function previewRefresh() {
            try { iframe.contentWindow.location.reload(); } catch(e) {}
        }

        // --- Other Utilities ---

        function clearCode() {
            if (clearModal) {
                clearModal.classList.remove('hidden');
                clearModal.classList.add('flex');
            }
        }

        function closeModal() {
            if (clearModal) {
                clearModal.classList.add('hidden');
                clearModal.classList.remove('flex');
            }
        }

        function confirmClear() {
            projectFiles = {};
            activeFile = '';
            editor.value = '';
            renderFileList();
            closeModal();
            consoleOutput.innerHTML = '';
            iframe.src = 'about:blank';
        }

        function toggleFullscreen() {
            const elem = document.getElementById('preview-pane');
            if (!document.fullscreenElement) {
                elem.requestFullscreen().catch(err => {
                    showMessage('Fullscreen Restricted', 'To use full-screen, please save the app and run it locally.');
                });
            } else {
                document.exitFullscreen();
            }
        }

        // --- Publish Modal Logic ---
        function showPublishModal() {
            if(publishModal) {
                publishModal.classList.remove('hidden');
                publishModal.classList.add('flex');
            }
        }

        function closePublishModal() {
            if(publishModal) {
                publishModal.classList.add('hidden');
                publishModal.classList.remove('flex');
            }
        }

        function showMessage(title, text) {
            if(msgTitle) msgTitle.textContent = title;
            if(msgText) msgText.innerText = text;
            if(messageModal) {
                messageModal.classList.remove('hidden');
                messageModal.classList.add('flex');
            }
        }

        function closeMessageModal() {
            if(messageModal) {
                messageModal.classList.add('hidden');
                messageModal.classList.remove('flex');
            }
        }

        function downloadApp() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'orbit-runner-app.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function openAppInNewWindow() {
            showMessage('Temporary Session', 'You are opening a temporary window.\n\nThis link CANNOT be bookmarked. To save a permanent version, please use the "Save Orbit" button.');

            if (projectFiles[activeFile] && !editor.disabled && !editor.readOnly) {
                projectFiles[activeFile].content = editor.value;
            }

            const safeFiles = JSON.stringify(projectFiles).replace(/<\/script>/g, '<\\/script>');

            const stateScript = `<script>
                window.__PRELOADED_FILES__ = ${safeFiles};
                window.__PRELOADED_ACTIVE__ = "${activeFile}";
            <\/script>`;

            let htmlContent = document.documentElement.outerHTML;
            htmlContent = htmlContent.replace('</head>', stateScript + '</head>');

            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            window.open(url, '_blank');
        }

        // --- Editor internals ---
        function setupEditorEvents() {
            if (editor) {
                editor.addEventListener('keydown', function(e) {
                    if (e.key == 'Tab') {
                        e.preventDefault();
                        const start = this.selectionStart;
                        const end = this.selectionEnd;
                        this.value = this.value.substring(0, start) + "  " + this.value.substring(end);
                        this.selectionStart = this.selectionEnd = start + 2;
                        updateLineNumbers();
                    }
                });
            }
        }

        function updateLineNumbers() {
            const lines = editor.value.split('\n').length;
            lineNumbers.innerHTML = Array(lines).fill(0).map((_, i) => `<div>${i + 1}</div>`).join('');
        }

        function syncScroll() {
            lineNumbers.scrollTop = editor.scrollTop;
        }

        // --- Console ---
        window.addEventListener('message', (event) => {
            if (event.data && event.data.source === 'orbit-runner') {
                logToConsole(event.data.type, event.data.message);
            }
        });

        function logToConsole(type, message) {
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            const time = new Date().toLocaleTimeString([], { hour12: false, hour: '2-digit', minute: '2-digit', second:'2-digit' });
            entry.innerHTML = `<span class="opacity-50 mr-2">[${time}]</span>${escapeHtml(message)}`;
            consoleOutput.appendChild(entry);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        function clearConsole(e) {
            if(e) e.stopPropagation();
            consoleOutput.innerHTML = '<div class="log-entry log-info opacity-50 italic">Console cleared.</div>';
        }

        function toggleConsole() {
            isConsoleCollapsed = !isConsoleCollapsed;
            if (isConsoleCollapsed) {
                consolePane.style.height = '30px';
                consoleChevron.style.transform = 'rotate(180deg)';
                consoleOutput.style.display = 'none';
            } else {
                consolePane.style.height = '192px';
                consoleChevron.style.transform = 'rotate(0deg)';
                consoleOutput.style.display = 'block';
            }
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Mobile View
        function setView(view) {
            const editorPane = document.getElementById('editor-pane');
            const previewPane = document.getElementById('preview-pane');
            const btnEditor = document.getElementById('btn-editor');
            const btnPreview = document.getElementById('btn-preview');

            if (view === 'editor') {
                editorPane.classList.remove('hidden');
                previewPane.classList.add('hidden');
                btnEditor.classList.add('text-blue-400', 'bg-gray-600');
                btnEditor.classList.remove('text-gray-400');
                btnPreview.classList.remove('text-blue-400', 'bg-gray-600');
                btnPreview.classList.add('text-gray-400');
            } else {
                editorPane.classList.add('hidden');
                previewPane.classList.remove('hidden');
                previewPane.classList.remove('md:flex');
                previewPane.classList.add('flex');
                btnPreview.classList.add('text-blue-400', 'bg-gray-600');
                btnPreview.classList.remove('text-gray-400');
                btnEditor.classList.remove('text-blue-400', 'bg-gray-600');
                btnEditor.classList.add('text-gray-400');
            }
        }
        
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 768) {
                const ep = document.getElementById('editor-pane');
                const pp = document.getElementById('preview-pane');
                if(ep) ep.classList.remove('hidden');
                if(pp) { pp.classList.remove('hidden'); pp.classList.add('flex'); }
            } else {
                setView('editor');
            }
        });

    </script>

</body></html>